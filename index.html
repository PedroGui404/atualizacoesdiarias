<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atualizações Diárias</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ícones (usando Heroicons) -->
    <script src="https://unpkg.com/@heroicons/react@1.0.5/outline.js" crossorigin="anonymous"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Cabeçalho -->
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800">Atualizações Diárias</h1>
            <button id="menuButton" class="flex items-center p-2 rounded-lg bg-blue-600 text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
                </svg>
                Menu
            </button>
        </header>

        <!-- Menu Lateral (inicialmente oculto) -->
        <div id="menuLateral" class="fixed inset-y-0 left-0 w-64 bg-white shadow-lg transform -translate-x-full transition-transform duration-300 z-50">
            <div class="p-4 border-b border-gray-200">
                <h2 class="text-xl font-semibold">Atualizações</h2>
                <button id="fecharMenu" class="absolute top-4 right-4 p-1">×</button>
            </div>
            <div class="p-4">
                <button id="adicionarAtualizacao" class="flex items-center justify-center w-full mb-4 p-2 bg-green-500 text-white rounded">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                    </svg>
                    <span class="ml-2">Adicionar</span>
                </button>
                <ul id="listaAtualizacoesMenu" class="space-y-2">
                    <!-- Itens serão adicionados dinamicamente via JS -->
                </ul>
            </div>
        </div>
        <div id="menuOverlay" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40"></div>

        <!-- Área Principal - Cards de Atualizações -->
        <div id="areaCards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Cards serão adicionados dinamicamente via JS -->
        </div>

        <!-- Modal para Adicionar/Editar -->
        <div id="modalAtualizacao" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="bg-white rounded-lg p-6 w-full max-w-md">
                <h2 class="text-xl font-semibold mb-4" id="modalTitulo">Adicionar Atualização</h2>
                <form id="formAtualizacao">
                    <input type="hidden" id="atualizacaoId">
                    <div class="mb-4">
                        <label for="nomeAtualizacao" class="block mb-2">Nome:</label>
                        <input type="text" id="nomeAtualizacao" class="w-full p-2 border rounded">
                    </div>
                    <div class="mb-4">
                        <label for="descricaoAtualizacao" class="block mb-2">Descrição:</label>
                        <textarea id="descricaoAtualizacao" class="w-full p-2 border rounded" rows="4"></textarea>
                    </div>
                    <div class="flex justify-end space-x-2">
                        <button type="button" id="cancelarModal" class="px-4 py-2 bg-gray-300 rounded">Cancelar</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded">Salvar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal para Selecionar Atualização (para edição no card) -->
        <div id="modalSelecionarAtualizacao" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="bg-white rounded-lg p-6 w-full max-w-md">
                <h2 class="text-xl font-semibold mb-4">Selecionar Atualização</h2>
                <select id="selectAtualizacao" class="w-full p-2 border rounded mb-4">
                    <!-- Opções serão preenchidas via JS -->
                </select>
                <div class="flex justify-end space-x-2">
                    <button type="button" id="cancelarSelecao" class="px-4 py-2 bg-gray-300 rounded">Cancelar</button>
                    <button type="button" id="confirmarSelecao" class="px-4 py-2 bg-blue-600 text-white rounded">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados das atualizações (simulando um banco de dados)
        let atualizacoes = [
            { id: 1, nome: "Atualização 1", descricao: "Descrição da atualização 1", data: "2023-05-15", status: "success" },
            { id: 2, nome: "Atualização 2", descricao: "Descrição da atualização 2", data: "2023-05-16", status: "success" }
        ];

        // Elementos DOM
        const menuButton = document.getElementById('menuButton');
        const fecharMenu = document.getElementById('fecharMenu');
        const menuLateral = document.getElementById('menuLateral');
        const menuOverlay = document.getElementById('menuOverlay');
        const listaAtualizacoesMenu = document.getElementById('listaAtualizacoesMenu');
        const areaCards = document.getElementById('areaCards');
        const adicionarAtualizacao = document.getElementById('adicionarAtualizacao');
        const modalAtualizacao = document.getElementById('modalAtualizacao');
        const modalTitulo = document.getElementById('modalTitulo');
        const formAtualizacao = document.getElementById('formAtualizacao');
        const nomeAtualizacao = document.getElementById('nomeAtualizacao');
        const descricaoAtualizacao = document.getElementById('descricaoAtualizacao');
        const atualizacaoId = document.getElementById('atualizacaoId');
        const cancelarModal = document.getElementById('cancelarModal');
        const modalSelecionarAtualizacao = document.getElementById('modalSelecionarAtualizacao');
        const selectAtualizacao = document.getElementById('selectAtualizacao');
        const cancelarSelecao = document.getElementById('cancelarSelecao');
        const confirmarSelecao = document.getElementById('confirmarSelecao');

        // Variável para controlar qual card está sendo editado
        let cardEditando = null;

        // Abrir menu lateral
        menuButton.addEventListener('click', () => {
            menuLateral.classList.remove('-translate-x-full');
            menuOverlay.classList.remove('hidden');
        });

        // Fechar menu lateral
        fecharMenu.addEventListener('click', () => {
            menuLateral.classList.add('-translate-x-full');
            menuOverlay.classList.add('hidden');
        });

        menuOverlay.addEventListener('click', () => {
            menuLateral.classList.add('-translate-x-full');
            menuOverlay.classList.add('hidden');
        });

        // Adicionar nova atualização
        adicionarAtualizacao.addEventListener('click', () => {
            modalTitulo.textContent = 'Adicionar Atualização';
            atualizacaoId.value = '';
            nomeAtualizacao.value = '';
            descricaoAtualizacao.value = '';
            modalAtualizacao.classList.remove('hidden');
        });

        // Cancelar modal
        cancelarModal.addEventListener('click', () => {
            modalAtualizacao.classList.add('hidden');
        });

        // Formulário de atualização
        formAtualizacao.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const id = atualizacaoId.value;
            const nome = nomeAtualizacao.value;
            const descricao = descricaoAtualizacao.value;
            const data = new Date().toISOString().split('T')[0];
            
            if (id) {
                // Editar existente
                const index = atualizacoes.findIndex(a => a.id == id);
                if (index !== -1) {
                    const status = atualizacoes[index].status || "success"; // Mantém o status atual
                    atualizacoes[index] = { id: Number(id), nome, descricao, data, status };
                }
            } else {
                // Adicionar novo
                const novoId = atualizacoes.length > 0 ? Math.max(...atualizacoes.map(a => a.id)) + 1 : 1;
                atualizacoes.push({ id: novoId, nome, descricao, data, status: "success" });
            }
            
            modalAtualizacao.classList.add('hidden');
            renderizarAtualizacoes();
        });

        // Renderizar atualizações no menu e nos cards
        function renderizarAtualizacoes() {
            // Limpar listas
            listaAtualizacoesMenu.innerHTML = '';
            
            // Adicionar ao menu
            atualizacoes.forEach(atualizacao => {
                const li = document.createElement('li');
                li.className = 'flex justify-between items-center p-2 hover:bg-gray-100 rounded cursor-pointer group';
                
                li.innerHTML = `
                    <span class="flex-grow" data-id="${atualizacao.id}">${atualizacao.nome}</span>
                    <div class="flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity">
                        <button class="editar-menu p-1 text-gray-500 hover:text-blue-600" data-id="${atualizacao.id}">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
                            </svg>
                        </button>
                        <button class="remover-menu p-1 text-gray-500 hover:text-red-600" data-id="${atualizacao.id}">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                `;
                
                // Adicionar evento para adicionar ao card
                li.querySelector('span').addEventListener('click', () => {
                    adicionarCard(atualizacao);
                    menuLateral.classList.add('-translate-x-full');
                    menuOverlay.classList.add('hidden');
                });
                
                // Adicionar evento para editar no menu
                li.querySelector('.editar-menu').addEventListener('click', (e) => {
                    e.stopPropagation();
                    const id = e.target.closest('button').getAttribute('data-id');
                    const atualizacao = atualizacoes.find(a => a.id == id);
                    if (atualizacao) {
                        modalTitulo.textContent = 'Editar Atualização';
                        atualizacaoId.value = atualizacao.id;
                        nomeAtualizacao.value = atualizacao.nome;
                        descricaoAtualizacao.value = atualizacao.descricao;
                        modalAtualizacao.classList.remove('hidden');
                    }
                });
                
                // Adicionar evento para remover do menu
                li.querySelector('.remover-menu').addEventListener('click', (e) => {
                    e.stopPropagation();
                    const id = e.target.closest('button').getAttribute('data-id');
                    atualizacoes = atualizacoes.filter(a => a.id != id);
                    
                    // Remover card correspondente se existir
                    const card = document.getElementById(`card-${id}`);
                    if (card) card.remove();
                    
                    renderizarAtualizacoes();
                });
                
                listaAtualizacoesMenu.appendChild(li);
            });
        }

        // Adicionar card à área principal
        function adicionarCard(atualizacao) {
            // Verificar se o card já existe
            const existingCard = document.getElementById(`card-${atualizacao.id}`);
            if (existingCard) {
                // Se o card já existe, apenas atualiza o status se necessário
                const statusIcon = existingCard.querySelector('.status-icon');
                if (statusIcon) {
                    statusIcon.innerHTML = getStatusIcon(atualizacao.status);
                }
                return;
            }
            
            const card = document.createElement('div');
            card.id = `card-${atualizacao.id}`;
            card.className = 'bg-white rounded-lg shadow-md p-4 relative hover:shadow-lg transition-shadow';
            
            card.innerHTML = `
                <div class="flex justify-between items-start">
                    <h3 class="font-semibold text-lg">${atualizacao.nome}</h3>
                    <button class="status-icon p-1 rounded-full hover:bg-gray-100 transition-colors" data-id="${atualizacao.id}" data-status="${atualizacao.status || 'success'}">
                        ${getStatusIcon(atualizacao.status || 'success')}
                    </button>
                </div>
                <p class="text-gray-600 mt-2">${atualizacao.descricao}</p>
                <div class="mt-4 text-sm text-gray-500">${atualizacao.data}</div>
                
                <!-- Menu de três pontos no canto inferior direito -->
                <div class="absolute bottom-2 right-2 dropdown">
                    <button class="p-1 text-gray-500 hover:text-gray-700 dropdown-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z" />
                        </svg>
                    </button>
                    <div class="dropdown-menu hidden absolute right-0 bottom-full mb-2 w-32 bg-white rounded-md shadow-lg z-10 border border-gray-200">
                        <button class="editar-card w-full text-left px-4 py-2 hover:bg-gray-100" data-id="${atualizacao.id}">Editar</button>
                        <button class="remover-card w-full text-left px-4 py-2 hover:bg-gray-100 text-red-500" data-id="${atualizacao.id}">Remover</button>
                    </div>
                </div>
            `;
            
            areaCards.appendChild(card);
            
            // Adicionar evento de clique no ícone de status
            const statusButton = card.querySelector('.status-icon');
            statusButton.addEventListener('click', (e) => {
                e.stopPropagation();
                const id = e.target.closest('button').getAttribute('data-id');
                const currentStatus = e.target.closest('button').getAttribute('data-status');
                const newStatus = currentStatus === 'success' ? 'error' : 'success';
                
                // Atualizar no botão
                e.target.closest('button').setAttribute('data-status', newStatus);
                e.target.closest('button').innerHTML = getStatusIcon(newStatus);
                
                // Atualizar nos dados
                const index = atualizacoes.findIndex(a => a.id == id);
                if (index !== -1) {
                    atualizacoes[index].status = newStatus;
                }
            });
            
            // Adicionar eventos aos dropdowns
            const dropdownToggle = card.querySelector('.dropdown-toggle');
            const dropdownMenu = card.querySelector('.dropdown-menu');
            
            dropdownToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                // Fechar todos os outros dropdowns
                document.querySelectorAll('.dropdown-menu').forEach(menu => {
                    if (menu !== dropdownMenu) menu.classList.add('hidden');
                });
                dropdownMenu.classList.toggle('hidden');
            });
            
            // Editar card - agora abre modal de seleção
            card.querySelector('.editar-card').addEventListener('click', (e) => {
                e.stopPropagation();
                const id = e.target.getAttribute('data-id');
                cardEditando = id;
                
                // Preencher o select com as atualizações disponíveis
                selectAtualizacao.innerHTML = '';
                atualizacoes.forEach(atualizacao => {
                    const option = document.createElement('option');
                    option.value = atualizacao.id;
                    option.textContent = atualizacao.nome;
                    if (atualizacao.id == id) option.selected = true;
                    selectAtualizacao.appendChild(option);
                });
                
                modalSelecionarAtualizacao.classList.remove('hidden');
                dropdownMenu.classList.add('hidden');
            });
            
            // Remover card
            card.querySelector('.remover-card').addEventListener('click', (e) => {
                e.stopPropagation();
                const id = e.target.getAttribute('data-id');
                card.remove();
                dropdownMenu.classList.add('hidden');
            });
            
            // Fechar dropdown ao clicar fora
            document.addEventListener('click', () => {
                dropdownMenu.classList.add('hidden');
            });
        }

        // Função para obter o ícone de status correto
        function getStatusIcon(status) {
            if (status === 'error') {
                return `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                    </svg>
                `;
            } else {
                return `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-500" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                    </svg>
                `;
            }
        }

        // Confirmar seleção de atualização para o card
        confirmarSelecao.addEventListener('click', () => {
            const novoId = selectAtualizacao.value;
            if (cardEditando && novoId) {
                // Encontrar o card existente e remover
                const card = document.getElementById(`card-${cardEditando}`);
                if (card) card.remove();
                
                // Adicionar a nova atualização como card
                const novaAtualizacao = atualizacoes.find(a => a.id == novoId);
                if (novaAtualizacao) {
                    adicionarCard(novaAtualizacao);
                }
                
                modalSelecionarAtualizacao.classList.add('hidden');
                cardEditando = null;
            }
        });

        // Cancelar seleção
        cancelarSelecao.addEventListener('click', () => {
            modalSelecionarAtualizacao.classList.add('hidden');
            cardEditando = null;
        });

        // Inicializar
        document.addEventListener('DOMContentLoaded', () => {
            renderizarAtualizacoes();
        });
    </script>
</body>
</html>